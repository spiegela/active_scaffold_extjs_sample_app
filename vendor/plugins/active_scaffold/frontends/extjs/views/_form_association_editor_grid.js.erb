<%
parent_record = @record
associated = column.singular_association? ? [parent_record.send(column.name)].compact : parent_record.send(column.name)
associated = associated.sort_by {|r| r.new_record? ? 99999999999 : r.id} unless column.association.options.has_key?(:order)
@record = column.association.klass.new
scope = column.plural_association? ? "[#{column.name}][#{@record.id || generate_temporary_id}]" : "[#{column.name}]"
-%>
{ xtype: 'editorgrid',
  title: '<%= column.label %>',
  collapsed: '<%= column.collapsed ? 'true' : 'false' %>',
  collapsible: 'true',
  stripeRows: 'true',
  remoteSort: 'true',
  listeners: {activate: function(){this.load();}},
  viewConfig: {
    forceFit:'true'
  },
  cm: <%= render :partial => "column_model.js.erb",
    :locals => {:columns => active_scaffold_config_for(@record.class).subform.columns} %>,
  ds: <%= render :partial => "data_source.js.erb",
    :locals => {:url => url_for(:controller => 'pets', :action => 'list') } %>
}
<% @record = parent_record -%>